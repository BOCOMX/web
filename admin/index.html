<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Panel de administración de BOCO - Gestión de blogs y proyectos" />
  <title>BOCO - Panel de Administración</title>
  
  <!-- Netlify Identity Widget -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
  
  <!-- Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms@^2.0.0/dist/netlify-cms.js"></script>
  
  <!-- Script personalizado para recorte de imágenes -->
  <script src="image-cropper.js"></script>
  
  <!-- Estilos personalizados para responsive -->
  <style>
    /* Estilos base */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    /* Header personalizado */
    .admin-header {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 1rem 2rem;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      text-align: center;
    }
    
    .admin-header h1 {
      color: #333;
      margin: 0;
      font-size: 1.8rem;
      font-weight: 600;
    }
    
    .admin-header p {
      color: #666;
      margin: 0.5rem 0 0 0;
      font-size: 0.9rem;
    }
    
    /* Contenedor principal */
    .admin-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    /* Responsive para móviles */
    @media (max-width: 768px) {
      .admin-header {
        padding: 1rem;
      }
      
      .admin-header h1 {
        font-size: 1.5rem;
      }
      
      .admin-container {
        padding: 1rem;
      }
    }
    
    /* Mejoras para el CMS */
    .nc-root {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    /* Botones personalizados */
    .nc-button {
      border-radius: 8px !important;
      font-weight: 500 !important;
    }
    
    /* Campos de formulario */
    .nc-field {
      border-radius: 8px !important;
    }
    
    /* Hints más visibles */
    .nc-hint {
      color: #666 !important;
      font-size: 0.85rem !important;
      margin-top: 0.25rem !important;
    }
    
    /* Estilos para hints de imágenes */
    .image-hint {
      margin: 8px 0;
    }
    
    .image-hint div {
      background: #f0f8ff !important;
      border: 1px solid #b3d9ff !important;
      border-radius: 6px !important;
      padding: 8px !important;
      font-size: 12px !important;
      color: #0066cc !important;
    }
    
    /* Indicadores de dimensiones */
    .image-indicator {
      position: absolute !important;
      top: 8px !important;
      right: 8px !important;
      background: rgba(0,0,0,0.7) !important;
      color: white !important;
      padding: 4px 8px !important;
      border-radius: 4px !important;
      font-size: 11px !important;
      pointer-events: none !important;
      z-index: 10 !important;
    }
    
    /* Mejoras para campos de fecha */
    .nc-widget-datetime input {
      font-size: 16px !important;
      padding: 12px !important;
    }
    
    /* Mejoras para campos de texto */
    .nc-widget-string input,
    .nc-widget-text textarea {
      font-size: 16px !important;
      padding: 12px !important;
      border-radius: 8px !important;
    }
    
    /* Mejoras para markdown */
    .nc-widget-markdown .CodeMirror {
      border-radius: 8px !important;
      font-size: 14px !important;
    }
  </style>
</head>
<body>
  <!-- Header personalizado -->
  <div class="admin-header">
    <h1>🐾 BOCO - Panel de Administración</h1>
    <p>Gestiona blogs y proyectos de rescate animal</p>
  </div>
  
  <!-- Contenedor del CMS -->
  <div class="admin-container">
    <!-- Netlify CMS se cargará aquí automáticamente -->
  </div>
  
  <!-- Script para mejorar la experiencia móvil -->
  <script>
    // Mejorar experiencia en móviles
    document.addEventListener('DOMContentLoaded', function() {
      // Detectar si es móvil
      const isMobile = window.innerWidth <= 768;
      
      if (isMobile) {
        // Agregar clase para estilos móviles
        document.body.classList.add('mobile-admin');
        
        // Mejorar navegación táctil
        const style = document.createElement('style');
        style.textContent = `
          .mobile-admin .nc-button {
            min-height: 44px !important;
            font-size: 16px !important;
          }
          
          .mobile-admin .nc-field input,
          .mobile-admin .nc-field textarea {
            font-size: 16px !important;
            padding: 12px !important;
          }
          
          .mobile-admin .nc-widget {
            margin-bottom: 1.5rem !important;
          }
          
          .mobile-admin .image-hint div {
            font-size: 11px !important;
            padding: 6px !important;
          }
        `;
        document.head.appendChild(style);
      }
    });
    
    // Redirigir después del login
    if (window.netlifyIdentity) {
      window.netlifyIdentity.on("login", () => {
        document.location.href = "/admin/";
      });
    }
    
    // Configuración adicional del CMS
    if (window.CMS) {
      // Mejorar la experiencia de carga de imágenes
      window.CMS.registerEventListener({
        name: 'preSave',
        handler: ({ entry }) => {
          console.log('Guardando entrada:', entry.get('title'));
        }
      });
      
      // Agregar validación personalizada
      window.CMS.registerWidget('string', {
        validate: function(value, field) {
          if (field.required && !value) {
            return 'Este campo es obligatorio';
          }
          return null;
        }
      });
    }
  </script>
</body>
</html>
